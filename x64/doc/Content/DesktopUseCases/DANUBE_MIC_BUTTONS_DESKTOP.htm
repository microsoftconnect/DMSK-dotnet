<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Use Cases" data-mc-conditions="Danube.Desktop">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Microphone button handling</title>
        <link href="../Resources/Stylesheets/DocLoc.css" rel="stylesheet" type="text/css" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <h1>Microphone button handling</h1>
        <p>Dragon Medical SpeechKit supports button events from microphones and control devices. Make sure that microphone button support is properly <a href="#EnablingMicButtonSupport">set up in your app</a>.</p>
        <p>Use the <code>ISession.ControlDeviceEventReceived</code> event to assign functionality to microphone buttons. This event is fired each time a supported button is pressed on a supported microphone.</p>
        <h2><a name="EnablingMicButtonSupport"></a>Enabling microphone button support</h2>
        <p>To support Nuance PowerMic and Philips SpeechMike buttons, add the following dependencies to your app's manifest file:</p>
        <ul>
            <li>
                <p>For x86 apps:</p>
                <p class="compact"><code>&lt;dependency&gt;</code> </p>
                <p class="compact2"><code>&lt;dependentAssembly&gt;</code> </p>
                <p class="compact3"><code>&lt;assemblyIdentity</code> </p>
                <p class="compact3"><code>type="win32"</code> </p>
                <p class="compact3"><code>name="Nuance.PowerMic"</code> </p>
                <p class="compact3"><code>version="&lt;Nuance.PowerMic assembly version&gt;"</code><![CDATA[  ]]></p>
                <p class="compact3"><code>processorArchitecture="x86"/&gt;</code> </p>
                <p class="compact2"><code>&lt;/dependentAssembly&gt;</code> </p>
                <p><code>&lt;/dependency&gt;</code>
                </p>
                <p class="compact"><code>&lt;dependency&gt;</code>
                </p>
                <p class="compact2"><code>&lt;dependentAssembly&gt;</code>
                </p>
                <p class="compact3"><code>&lt;assemblyIdentity</code>
                </p>
                <p class="compact3"><code>type="win32"</code>
                </p>
                <p class="compact3"><code>name="Philips.SpeechMike"</code>
                </p>
                <p class="compact3"><code>version="&lt;Philips.SpeechMike assembly version&gt;"</code><![CDATA[  ]]></p>
                <p class="compact3"><code>processorArchitecture="x86"/&gt;</code>
                </p>
                <p class="compact2"><code>&lt;/dependentAssembly&gt;</code>
                </p>
                <p><code>&lt;/dependency&gt;</code>
                </p>
            </li>
            <li>
                <p>For x64 apps:</p>
                <p class="compact"><code>&lt;dependency&gt;</code> </p>
                <p class="compact2"><code>&lt;dependentAssembly&gt;</code> </p>
                <p class="compact3"><code>&lt;assemblyIdentity</code> </p>
                <p class="compact3"><code>type="win32"</code> </p>
                <p class="compact3"><code>name="Nuance.PowerMic"</code> </p>
                <p class="compact3"><code>version="&lt;Nuance.PowerMic assembly version&gt;"</code><![CDATA[  ]]></p>
                <p class="compact3"><code>processorArchitecture="amd64"/&gt;</code> </p>
                <p class="compact2"><code>&lt;/dependentAssembly&gt;</code> </p>
                <p><code>&lt;/dependency&gt;</code> </p>
                <p class="compact"><code>&lt;dependency&gt;</code> </p>
                <p class="compact2"><code>&lt;dependentAssembly&gt;</code> </p>
                <p class="compact3"><code>&lt;assemblyIdentity</code> </p>
                <p class="compact3"><code>type="win32"</code> </p>
                <p class="compact3"><code>name="Philips.SpeechMike"</code> </p>
                <p class="compact3"><code>version="&lt;Philips.SpeechMike assembly version&gt;"</code><![CDATA[  ]]></p>
                <p class="compact3"><code>processorArchitecture="amd64"/&gt;</code> </p>
                <p class="compact2"><code>&lt;/dependentAssembly&gt;</code> </p>
                <p><code>&lt;/dependency&gt;</code> </p>
            </li>
        </ul>
        <h3>Remarks</h3>
        <ul>
            <li>If you're using Philips SpeechMike, we recommend always installing the latest SpeechMike firmware.</li>
            <li>Nuance supports the use of <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> in combination with the Nuance.PowerMic and Philips.SpeechMike assembly versions distributed with that <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> package. Newer versions that the vendor guarantees to be binary backwards compatible can also be used.</li>
            <li>
                <p>The <code>GetAudioDevices()</code> function and the <code>AudioDevice</code> property are deprecated. It's still possible, but not recommended to use them on the shared session object to retrieve the available audio devices and override the default device.</p>
            </li>
            <li>
                <p>The user can select a microphone via the user interface. The selected microphone will be remembered for the user and given precedence over any integration-defined audio device. For more information, see the 'Speak' topic of the integrated end user help.</p>
            </li>
        </ul>
        <h2><a name="Button_mapping"></a>Customizable buttons</h2>
        <p>You can customize some microphone buttons via your integration. When these buttons are pressed, <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> sends notifications to your app via the <code>ControlDeviceEventReceived</code> event. Use these notifications to trigger custom functionality in your app, such as opening and closing a report. For more information, see: <a href="DANUBE_EVENTS_DESKTOP.htm#Session_events">Session events</a>.</p>
        <p>To be notified about button presses, do the following:</p>
        <ol>
            <li value="1">Add an event handler for the <code>ControlDeviceEventReceived</code> event exposed by the <code>ISessionEvents</code> interface. This will be invoked whenever the user presses a customizable microphone button while the session is open.</li>
            <li value="2">In the event handler, invoke the corresponding functionality based on the value of the <code>cdEvent</code> parameter. This is one of the values of the <code>ControlDeviceEvent</code> enumeration, indicating which microphone button is pressed by the user.</li>
        </ol>
        <h3>Button mapping</h3>
        <p class="wide">The Nuance PowerMic III buttons are as follows:</p>
        <p>
            <img src="../Resources/PowerMic.png" style="max-width: 600px;" alt="" />
        </p>
        <p>The mapping between the <code>ControlDeviceEvent</code> enumeration values and the physical microphone buttons varies depending on the microphone model.</p>
        <p>This table shows the mapping for Nuance PowerMic and Philips SpeechMike devices:</p>
        <table>
            <col />
            <col />
            <col />
            <col />
            <col />
            <thead>
                <tr>
                    <th><code>ControlDeviceEvent</code> value</th>
                    <th>
                        <p>Nuance PowerMic III button name</p>
                    </th>
                    <th>Philips SpeechMike button name</th>
                    <th>Nuance PowerMic 4 button name</th>
                    <th>Default <span class="mc-variable DocLoc.SoD_US_Short variable">Dragon Medical One</span>/<span class="mc-variable DocLoc.SoD_EMEA_Short variable">DM Direct</span> functionality</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>Button1Pressed</code>
                    </td>
                    <td>Transcribe</td>
                    <td>EOL</td>
                    <td>Rear function button</td>
                    <td>Transfer text</td>
                </tr>
                <tr>
                    <td><code>Button2Pressed</code>
                    </td>
                    <td>Enter/Select</td>
                    <td>Command</td>
                    <td>Enter/Select</td>
                    <td>Accept defaults</td>
                </tr>
                <tr>
                    <td><code>Button3Pressed</code>
                    </td>
                    <td>Customizable Right</td>
                    <td>Insert/Overwrite</td>
                    <td>Function D</td>
                    <td>Show/hide dictation box</td>
                </tr>
                <tr>
                    <td><code>Button4Pressed</code>
                    </td>
                    <td>
                        <p>Tab Backward</p>
                    </td>
                    <td>F1</td>
                    <td>Tab Backward</td>
                    <td>Previous field</td>
                </tr>
                <tr>
                    <td><code>Button5Pressed</code>
                    </td>
                    <td>Tab Forward</td>
                    <td>F2</td>
                    <td>Tab Forward</td>
                    <td>Next field</td>
                </tr>
                <tr>
                    <td><code>Button6Pressed</code>
                    </td>
                    <td>Customizable Left</td>
                    <td>F4</td>
                    <td>Function B</td>
                    <td><i>No default</i>
                    </td>
                </tr>
                <tr>
                    <td><code>Button7Pressed</code>
                    </td>
                    <td><i>Reserved for future use</i>
                    </td>
                    <td><i>Reserved for future use</i>
                    </td>
                    <td><i>Reserved for future use</i>
                    </td>
                    <td><i>No default</i>
                    </td>
                </tr>
                <tr>
                    <td><code>Button8Pressed</code>
                    </td>
                    <td><i>Not mapped to a button</i>
                    </td>
                    <td>F3</td>
                    <td>Function C</td>
                    <td><i>No default</i>
                    </td>
                </tr>
                <tr>
                    <td><code>Button9Pressed</code>
                    </td>
                    <td><i>Not mapped to a button</i>
                    </td>
                    <td><i>Not mapped to a button</i>
                    </td>
                    <td>Function A</td>
                    <td><i>No default</i>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2>Non-customizable buttons</h2>
        <p>You can't customize the following microphone buttons: <span class="userInterface">Play</span>, <span class="userInterface">Stop</span>, <span class="userInterface">Record</span>, <span class="userInterface">Fast Forward</span> and <span class="userInterface">Fast Rewind</span>. No values of the <code>ControlDeviceEvent</code> enumeration map to these buttons; your app doesn't receive notifications when these buttons are pressed.</p>
        <p>These buttons provide the following standard functionality out of the box:</p>
        <p class="indent2"><span class="userInterface">Record</span>: Starts recording audio.</p>
        <p class="indent2"><span class="userInterface">Stop</span>: Stops recording.</p>
        <p class="indent2"><span class="userInterface">Fast Forward</span>: Moves the cursor to the next field.</p>
        <p class="indent2"><span class="userInterface">Fast Rewind</span>: Moves the cursor to the previous field.</p>
        <p>For more information on using these buttons, see the 'Microphones' topic in the <span class="userInterface">Help</span> section of the personalization &amp; help window.</p>
        <h3>See also</h3>
        <p class="indent2">The <a href="../API/NuanceDragonMedicalSpeechKitAPIReference.chm">API Reference</a> documentation</p>
    </body>
</html>