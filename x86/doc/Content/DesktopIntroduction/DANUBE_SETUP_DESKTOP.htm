<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="" data-mc-conditions="Danube.Desktop">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>
			Setting up Dragon Medical SpeechKit</title>
        <link href="../Resources/Stylesheets/DocLoc.css" rel="stylesheet" type="text/css" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <h1><a name="kanchor14"></a>Setting up <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span></h1>
        <h2>Requirements</h2>
        <p>For more information on supported software versions, see the corresponding release notes.</p>
        <p class="warning"><span class="important">Important:</span> Spell checkers or other infrastructure that modifies text while speech recognition is active might cause speech recognition results to be inserted at an unexpected location. Make sure to deactivate spell checkers or such infrastructure in your integration.</p>
        <h2>Package contents</h2>
        <p><b><span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span></b> contains:</p>
        <p class="compact2">SDK binaries</p>
        <p class="compact2">SDK samples</p>
        <p class="indent2">API Reference documentation and SDK documentation</p>
        <h2>x64 and x86 SDKs</h2>
        <p>SDK binaries are built for specific architectures and the corresponding one must be used:</p>
        <ul>
            <li>
                <p>Use the x64 SDK&#160;if you are building your app as x64.</p>
            </li>
            <li>
                <p>Use the x86 SDK&#160;if you are building your app as x86.</p>
            </li>
        </ul>
        <p>When compiling, we recommend using the corresponding <b>x64</b> and <b>x86</b> platform target. The use of <b>anycpu</b> won't resolve app configuration issues from the use of the x64 SDK with an x86 project or vice versa. For more information, see <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/output">https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/output</a>.</p>
        <h2>Referencing <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span></h2>
        <p>To use <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> in your app, add a reference to the Nuance.SpeechAnywhere.dll assembly to your Visual Studio .Net application project.</p>
        <p>Also, add the following to your app's manifest file for x86 apps:</p>
        <p class="compact"><code>&lt;dependency&gt;</code> </p>
        <p class="compact2"><code>&lt;dependentAssembly&gt;</code> </p>
        <p class="compact3"><code>&lt;assemblyIdentity</code> </p>
        <p class="compact3"><code>type="win32"</code> </p>
        <p class="compact3"><code>name="SpeechMagic.DictationDevices"</code><![CDATA[  ]]></p>
        <p class="compact3"><code>version="&lt;SpeechMagic.DictationDevices assembly version&gt;"</code><![CDATA[  ]]></p>
        <p class="compact3"><code>processorArchitecture="x86"/&gt;</code> </p>
        <p class="compact2"><code>&lt;/dependentAssembly&gt;</code> </p>
        <p><code>&lt;/dependency&gt;</code> </p>
        <p>Add the following to your app's manifest file for x64 apps:</p>
        <p class="compact"><code>&lt;dependency&gt;</code> </p>
        <p class="compact2"><code>&lt;dependentAssembly&gt;</code> </p>
        <p class="compact3"><code>&lt;assemblyIdentity</code> </p>
        <p class="compact3"><code>type="win32"</code> </p>
        <p class="compact3"><code>name="SpeechMagic.DictationDevices"</code><![CDATA[  ]]></p>
        <p class="compact3"><code>version="&lt;SpeechMagic.DictationDevices assembly version&gt;"</code><![CDATA[  ]]></p>
        <p class="compact3"><code>processorArchitecture="amd64"/&gt;</code> </p>
        <p class="compact2"><code>&lt;/dependentAssembly&gt;</code> </p>
        <p><code>&lt;/dependency&gt;</code> </p>
        <h3>Remarks</h3>
        <ul>
            <li><code>"&lt;SpeechMagic.DictationDevices assembly version&gt;"</code> must be the version in the SpeechMagic.DictationDevices.manifest file.</li>
            <li>To use SpeechMagic.AudioFull (instead of SpeechMagic.DictationDevices) in your app, make sure the corresponding name and version are in the app’s manifest file. The contents of the <b>SpeechMagic.AudioFull</b> package must be located in the folder with the app’s EXE file.</li>
            <li>
                <p>The SpeechMagic.AudioFull assembly must have the same version as the SpeechMagic.DictationDevices assembly it replaces. Nuance only supports the combination of versions distributed in the <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> package. To deploy a different combination of versions, contact Nuance support.</p>
            </li>
        </ul>
        <h2>Enabling microphone button support</h2>
        <p>For more information, see <a href="../DesktopUseCases/DANUBE_MIC_BUTTONS_DESKTOP.htm">Microphone button handling</a>.</p>
        <p>To support Nuance PowerMic and Philips SpeechMike buttons, add the following dependencies to your app's manifest file:</p>
        <ul>
            <li>
                <p>For x86 apps:</p>
                <p class="compact"><code>&lt;dependency&gt;</code> </p>
                <p class="compact2"><code>&lt;dependentAssembly&gt;</code> </p>
                <p class="compact3"><code>&lt;assemblyIdentity</code> </p>
                <p class="compact3"><code>type="win32"</code> </p>
                <p class="compact3"><code>name="Nuance.PowerMic"</code> </p>
                <p class="compact3"><code>version="&lt;Nuance.PowerMic assembly version&gt;"</code><![CDATA[  ]]></p>
                <p class="compact3"><code>processorArchitecture="x86"/&gt;</code> </p>
                <p class="compact2"><code>&lt;/dependentAssembly&gt;</code> </p>
                <p><code>&lt;/dependency&gt;</code>
                </p>
                <p class="compact"><code>&lt;dependency&gt;</code>
                </p>
                <p class="compact2"><code>&lt;dependentAssembly&gt;</code>
                </p>
                <p class="compact3"><code>&lt;assemblyIdentity</code>
                </p>
                <p class="compact3"><code>type="win32"</code>
                </p>
                <p class="compact3"><code>name="Philips.SpeechMike"</code>
                </p>
                <p class="compact3"><code>version="&lt;Philips.SpeechMike assembly version&gt;"</code><![CDATA[  ]]></p>
                <p class="compact3"><code>processorArchitecture="x86"/&gt;</code>
                </p>
                <p class="compact2"><code>&lt;/dependentAssembly&gt;</code>
                </p>
                <p><code>&lt;/dependency&gt;</code>
                </p>
            </li>
            <li>
                <p>For x64 apps:</p>
                <p class="compact"><code>&lt;dependency&gt;</code> </p>
                <p class="compact2"><code>&lt;dependentAssembly&gt;</code> </p>
                <p class="compact3"><code>&lt;assemblyIdentity</code> </p>
                <p class="compact3"><code>type="win32"</code> </p>
                <p class="compact3"><code>name="Nuance.PowerMic"</code> </p>
                <p class="compact3"><code>version="&lt;Nuance.PowerMic assembly version&gt;"</code><![CDATA[  ]]></p>
                <p class="compact3"><code>processorArchitecture="amd64"/&gt;</code> </p>
                <p class="compact2"><code>&lt;/dependentAssembly&gt;</code> </p>
                <p><code>&lt;/dependency&gt;</code> </p>
                <p class="compact"><code>&lt;dependency&gt;</code> </p>
                <p class="compact2"><code>&lt;dependentAssembly&gt;</code> </p>
                <p class="compact3"><code>&lt;assemblyIdentity</code> </p>
                <p class="compact3"><code>type="win32"</code> </p>
                <p class="compact3"><code>name="Philips.SpeechMike"</code> </p>
                <p class="compact3"><code>version="&lt;Philips.SpeechMike assembly version&gt;"</code><![CDATA[  ]]></p>
                <p class="compact3"><code>processorArchitecture="amd64"/&gt;</code> </p>
                <p class="compact2"><code>&lt;/dependentAssembly&gt;</code> </p>
                <p><code>&lt;/dependency&gt;</code> </p>
            </li>
        </ul>
        <h3>Remarks</h3>
        <ul>
            <li>If you're using Philips SpeechMike, we recommend always installing the latest SpeechMike firmware.</li>
            <li>Nuance supports the use of <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> in combination with the Nuance.PowerMic and Philips.SpeechMike assembly versions distributed with that <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> package. Newer versions that the vendor guarantees to be binary backwards compatible can also be used.</li>
            <li>
                <p>The <code>GetAudioDevices()</code> function and the <code>AudioDevice</code> property are deprecated. It's still possible, but not recommended to use them on the shared session object to retrieve the available audio devices and override the default device.</p>
            </li>
            <li>
                <p>The user can select a microphone via the user interface. The selected microphone will be remembered for the user and given precedence over any integration-defined audio device. For more information, see the 'Speak' topic of the integrated end user help.</p>
            </li>
        </ul>
        <h2>Deploying <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> with your app</h2>
        <p>Copy the contents of the <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span> package <span class="path">bin</span> folder to your app directory. Also copy the contents of the <b>SpeechMagic.AudioFull</b> package here, if necessary (see above).</p>
        <h2>Publishing a Microsoft Windows ClickOnce app</h2>
        <p>To publish the <span class="userInterface">S_DM_SpeechKit</span> sample project (or your app based on <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span>) as a Microsoft Windows ClickOnce app, do the following:</p>
        <ol>
            <li value="1">In the Visual Studio <span class="userInterface">Solution Explorer</span>, open the <span class="userInterface">S_DM_SpeechKit</span> sample project.</li>
            <li value="2">In <span class="path">app.manifest</span>, remove the <span class="path">SpeechMagic.DictationDevices</span>, <span class="path">Philips.SpeechMike</span> and <span class="path">Nuance.PowerMic</span> dependencies.</li>
            <li value="3">Select and hold (or right-click) the <span class="userInterface">S_DM_SpeechKit</span> sample project and select <span class="userInterface">Add reference</span>; the <span class="userInterface">Reference Manager</span> dialog box is displayed.</li>
            <li value="4">Select <span class="path">Nuance.PowerMic.manifest</span>, <span class="path">Philips.SpeechMike.manifest</span> and <span class="path">SpeechMagic.DictationDevices.manifest</span>.</li>
            <li value="5">Select and hold (or right-click) the <span class="userInterface">S_DM_SpeechKit</span> sample project and select <span class="userInterface">Properties</span>.</li>
            <li value="6">On the <span class="userInterface">Security</span> tab, select <span class="userInterface">Enable ClickOnce security settings</span>.</li>
            <li value="7">On the <span class="userInterface">Publish</span> tab, enter the <span class="userInterface">Publishing Folder Location (web site, ftp, or file path)</span> and <span class="userInterface">Installation Folder URL (if different than above)</span> and select <span class="userInterface">Publish Wizard</span>.</li>
            <li value="8">Follow the wizard to decide where the app will be installed from and if the app will be available offline or online only.</li>
            <li value="9">
                <p>Select and hold (or right-click) the <span class="userInterface">S_DM_SpeechKit</span> sample project, select <span class="userInterface">Add</span> &gt; <span class="userInterface">Existing Item</span> and add the following files to your project:</p>
                <ul>
                    <li>
                        <p>From the <span class="path">Philips.SpeechMike</span> folder: <span class="path">PIA.SpMikeCtrl.dll</span></p>
                    </li>
                    <li>
                        <p>From the <span class="path">bin</span> folder: <span class="path">NuCaAudioController.dll</span>, <span class="path">NuCaAudioController.ini</span>, <span class="path">NuCaAudioControllerCLI.dll</span>, <span class="path">NuCaClient.cfg</span>, <span class="path">NuCaStreamDrv.dll</span>, <span class="path">pspapdrv.dll</span>, <span class="path">pspaudrv.dll</span>, <span class="path">pspsbext.dll</span>, <span class="path">SmAudioDrv.dll</span>, <span class="path">SmAudioDrv.ini</span>, <span class="path">ncaaudiodev.ini</span>, <span class="path">PIA.SmXAudioLib.dll</span>, <span class="path">SmControlDrv.ini</span>, <span class="path">smxlog.ini.template</span> and <span class="path">SpeexLicense.txt</span></p>
                    </li>
                </ul>
            </li>
            <li value="10">Select <span class="userInterface">Publish Now</span> to build your ClickOnce app.</li>
        </ol>
        <h2>Sharing assemblies with <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span></h2>
        <p>If your app depends on a third party assembly (for example, log4net) which is also used by <span class="mc-variable DocLoc.DM_SK variable">Dragon Medical SpeechKit</span>, no action is required if it uses the same version of the assembly.</p>
        <p>If your app uses a different version of the assembly, and the newer version of the shared assembly is fully binary compatible with the older one, you must deploy the newer version of the assembly along with your app and verify that the .NET assembly loader accepts and loads that version instead of the older one. To do this, add the following to your app’s manifest file for every shared assembly:</p>
        <p class="compact"><code>&lt;runtime&gt;</code> </p>
        <p class="compact2"><code>&lt;assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1"&gt;</code> </p>
        <p class="compact3"><code>&lt;dependentAssembly&gt;</code> </p>
        <p class="compact4"><code>&lt;assemblyIdentity name="&lt;name&gt;" publicKeyToken="&lt;publicKeyToken value&gt;" /&gt;</code> </p>
        <p class="compact4"><code>&lt;bindingRedirect oldVersion="&lt;oldVersion value&gt;" newVersion="&lt;newVersion value&gt;" /&gt;</code> </p>
        <p class="compact3"><code>&lt;/dependentAssembly&gt;</code> </p>
        <p class="compact2"><code>&lt;/assemblyBinding&gt;</code> </p>
        <p class="indent"><code>&lt;/runtime&gt;</code> </p>
        <p>  In the above code snippet, replace <code>&lt;name&gt;</code>, <code>&lt;publicKeyToken value&gt;</code>, <code>&lt;oldVersion value&gt;</code> and <code>&lt;newVersion value&gt;</code> by values that are applicable to the shared assembly.</p>
        <p class="note"><b>Note:</b> If the newer version of the shared assembly is not fully binary compatible with the older one, you must deploy both versions of the assembly (in separate subfolders) along with your appand programmatically load the right version. For more information, see: <a href="http://msdn.microsoft.com/en-us/library/ff527268(v=vs.110).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/ff527268%28v=vs.110%29.aspx</a>.</p>
        <h3>See also</h3>
        <p class="compact2"><a href="DANUBE_TECHNICAL_RESTRICTIONS_DESKTOP.htm">Technical restrictions</a>
        </p>
        <p class="compact2"><a href="../Appendix/DANUBE_GLOSSARY.htm">Glossary</a>
        </p>
    </body>
</html>